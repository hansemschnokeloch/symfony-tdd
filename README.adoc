// settings:

:toc: macro
:toc-title: Sommaire
:toclevels: 3
:numbered:

ifndef::env-github[:icons: font]
ifdef::env-github[]
:status:
:outfilesuffix: .adoc
:caution-caption: :fire:
:important-caption: :exclamation:
:note-caption: :paperclip:
:tip-caption: :bulb:
:warning-caption: :warning:
endif::[]

// Variables:

:uri-org: https://github.com/jprivet-dev
:uri-repo: {uri-org}/symfony-tdd

:uri-rel-file-base: link:
:uri-rel-tree-base: link:
ifdef::env-site,env-yard[]
:uri-rel-file-base: {uri-repo}/blob/master/
:uri-rel-tree-base: {uri-repo}/tree/master/
endif::[]

:uri-license: {uri-rel-file-base}LICENSE

:BACK_TO_TOP_TARGET: top-target
:BACK_TO_TOP_LABEL: ⬆ Retour au sommaire
:BACK_TO_TOP: <<{BACK_TO_TOP_TARGET},{BACK_TO_TOP_LABEL}>>

[#{BACK_TO_TOP_TARGET}]
= Symfony 4 & TDD (Workshop)

|===
| Branch 3+| Status

| https://github.com/jprivet-dev/symfony-tdd[master]
| image:https://travis-ci.org/jprivet-dev/symfony-tdd.svg?branch=master["Build Status", link="https://travis-ci.org/jprivet-dev/symfony-tdd"]
| image:https://coveralls.io/repos/github/jprivet-dev/symfony-tdd/badge.svg?branch=master["Coverage Status", link="https://coveralls.io/github/jprivet-dev/symfony-tdd?branch=master"]
| image:https://api.codacy.com/project/badge/Grade/d83935eebccc4610870a0b52039914f3?branch=master["Codacy code quality", link="https://www.codacy.com/manual/jprivet-dev/symfony-tdd?utm_source=github.com&utm_medium=referral&utm_content=jprivet-dev/symfony-tdd&utm_campaign=Badge_Grade"]

| https://github.com/jprivet-dev/symfony-tdd/tree/dev[dev]
| image:https://travis-ci.org/jprivet-dev/symfony-tdd.svg?branch=dev["Build Status", link="https://travis-ci.org/jprivet-dev/symfony-tdd"]
| image:https://coveralls.io/repos/github/jprivet-dev/symfony-tdd/badge.svg?branch=dev["Coverage Status", link="https://coveralls.io/github/jprivet-dev/symfony-tdd?branch=dev"]
| image:https://api.codacy.com/project/badge/Grade/d83935eebccc4610870a0b52039914f3?branch=dev["Codacy code quality", link="https://www.codacy.com/manual/jprivet-dev/symfony-tdd?utm_source=github.com&utm_medium=referral&utm_content=jprivet-dev/symfony-tdd&utm_campaign=Badge_Grade"]
|===

toc::[]

== Présentation

Ce repo est mon atelier pour tester et partager des cas pratiques autour du *TDD* (Test-Driven Development) et du framework *Symfony*.

J'ai démarré cet atelier "dockerisé" à partir du repo https://github.com/dunglas/symfony-docker de  https://dunglas.fr/[Kevin Dunglas].

== Prérequis technique : avoir *Docker CE* et *Docker Compose* installés

* https://docs.docker.com/install/
* https://docs.docker.com/compose/install/

{BACK_TO_TOP}

== Démarrer avec le projet

=== Récupérer le repo

```sh
$ git clone git@github.com:jprivet-dev/symfony-tdd.git
```
=== Démarrer le projet

```sh
$ cd symfony-tdd
$ docker-compose up -d
```
=== Accéder au projet

Aller sur https://localhost

{BACK_TO_TOP}

== Jouer avec les tests automatiques & *PHPUnit*

=== Lancer les tests avec *PHPUnit*

Le projet utilise le *PHPUnit Bridge* de *Symfony* (https://symfony.com/doc/current/testing.html) :

```sh
$ docker-compose exec app ./vendor/bin/simple-phpunit
```

=== *PHPUnit Watcher* : relancer automatiquement les tests après modification d'un fichier `.php`

Le projet utilise ce _watcher_ très pratique (https://github.com/spatie/phpunit-watcher) :

```sh
$ docker-compose exec app ./vendor/bin/phpunit-watcher watch
```

{BACK_TO_TOP}

== Sujets traités

=== Principes utilisés dans des projets *"clients"*

==== Ne plus injecter *l'entity manager*

Ressources :

* https://matthiasnoback.nl/2014/05/inject-a-repository-instead-of-an-entity-manager/

Fichiers :

* {uri-rel-file-base}src/Repository/AbstractRepository.php[]
* {uri-rel-file-base}tests/Unit/Repository/AbstractRepositoryTest.php[]

{BACK_TO_TOP}

==== Créer et tester un *repository*

{BACK_TO_TOP}

==== Créer et tester une *classe abstraite*

Ressources :

* https://phpunit.readthedocs.io/en/8.4/test-doubles.html#mocking-traits-and-abstract-classes
* https://mnapoli.fr/anonymous-classes-in-tests/

Fichiers :

* {uri-rel-file-base}src/Util/Example/AbstractClassExample.php[]
* {uri-rel-file-base}tests/Unit/Util/Example/AbstractClassExampleTest.php[]

{BACK_TO_TOP}

==== Créer et tester un *custom validator*

Ressources :

* https://symfony.com/doc/current/validation/custom_constraint.html
* https://github.com/symfony/validator/blob/master/Test/ConstraintValidatorTestCase.php
* https://github.com/symfony/validator/blob/master/Tests/Constraints/EmailValidatorTest.php

Fichiers :

* {uri-rel-file-base}src/Validator/Constraints/Reference.php[]
* {uri-rel-file-base}src/Validator/Constraints/ReferenceValidator.php[]
* {uri-rel-file-base}tests/Unit/Validator/Constraints/ReferenceValidatorTest.php[]

{BACK_TO_TOP}

==== Créer et tester un *custom type*

{BACK_TO_TOP}

==== Créer et tester une *fonction Twig*

{BACK_TO_TOP}

==== Créer un *smoke testing*

{BACK_TO_TOP}

==== Créer, dispatcher et tester un *event*

{BACK_TO_TOP}

==== Mocker le *temps*

{BACK_TO_TOP}

==== Créer et tester une *commande Symfony*

{BACK_TO_TOP}

==== Créer et tester une *requête ajax*

{BACK_TO_TOP}

==== Travailler avec le *workflow component*

{BACK_TO_TOP}

==== Travailler avec le *process bundle*

{BACK_TO_TOP}

=== R&D

==== Travailler avec des *collections d'objets typés*

{BACK_TO_TOP}

==== La performance avec *Doctrine*

{BACK_TO_TOP}

==== Créer et tester un *trait*

{BACK_TO_TOP}

==== Créer et tester un *composant Vue.js*

{BACK_TO_TOP}

==== Créer et tester des *éléments asynchrones PHP*

{BACK_TO_TOP}

== Licence

`symfony-tdd` est publié sous {uri-license}[LICENSE] *MIT*.

{BACK_TO_TOP}
